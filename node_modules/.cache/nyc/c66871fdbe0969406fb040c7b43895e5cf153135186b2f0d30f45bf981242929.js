var cov_2i7ou9xy9q=function(){var path="/Users/tpt-johnhatcher/code/social-directory/lib/GoogleSheet.tests.js";var hash="26468975b8ccda4610193ddebee78ba6e3a8c5c5";var Function=function(){}.constructor;var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/tpt-johnhatcher/code/social-directory/lib/GoogleSheet.tests.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:30}},"1":{start:{line:2,column:19},end:{line:2,column:34}},"2":{start:{line:3,column:20},end:{line:3,column:44}},"3":{start:{line:5,column:0},end:{line:155,column:3}},"4":{start:{line:12,column:2},end:{line:35,column:5}},"5":{start:{line:13,column:4},end:{line:19,column:6}},"6":{start:{line:21,column:4},end:{line:32,column:6}},"7":{start:{line:34,column:4},end:{line:34,column:41}},"8":{start:{line:37,column:2},end:{line:43,column:5}},"9":{start:{line:38,column:4},end:{line:42,column:7}},"10":{start:{line:39,column:17},end:{line:39,column:40}},"11":{start:{line:41,column:6},end:{line:41,column:47}},"12":{start:{line:45,column:2},end:{line:102,column:5}},"13":{start:{line:46,column:19},end:{line:46,column:37}},"14":{start:{line:47,column:20},end:{line:47,column:35}},"15":{start:{line:48,column:18},end:{line:48,column:28}},"16":{start:{line:51,column:4},end:{line:59,column:7}},"17":{start:{line:52,column:6},end:{line:52,column:35}},"18":{start:{line:54,column:6},end:{line:58,column:9}},"19":{start:{line:55,column:8},end:{line:55,column:56}},"20":{start:{line:56,column:8},end:{line:56,column:46}},"21":{start:{line:57,column:8},end:{line:57,column:39}},"22":{start:{line:61,column:4},end:{line:69,column:7}},"23":{start:{line:62,column:6},end:{line:68,column:21}},"24":{start:{line:64,column:10},end:{line:64,column:44}},"25":{start:{line:65,column:10},end:{line:65,column:46}},"26":{start:{line:71,column:4},end:{line:81,column:7}},"27":{start:{line:72,column:6},end:{line:72,column:47}},"28":{start:{line:73,column:6},end:{line:75,column:9}},"29":{start:{line:74,column:8},end:{line:74,column:30}},"30":{start:{line:77,column:6},end:{line:80,column:9}},"31":{start:{line:78,column:8},end:{line:78,column:45}},"32":{start:{line:79,column:8},end:{line:79,column:15}},"33":{start:{line:83,column:4},end:{line:87,column:7}},"34":{start:{line:84,column:6},end:{line:84,column:36}},"35":{start:{line:85,column:6},end:{line:85,column:40}},"36":{start:{line:86,column:6},end:{line:86,column:42}},"37":{start:{line:89,column:4},end:{line:92,column:7}},"38":{start:{line:90,column:6},end:{line:90,column:36}},"39":{start:{line:91,column:6},end:{line:91,column:44}},"40":{start:{line:94,column:4},end:{line:101,column:7}},"41":{start:{line:95,column:6},end:{line:95,column:45}},"42":{start:{line:96,column:6},end:{line:96,column:36}},"43":{start:{line:97,column:6},end:{line:100,column:10}},"44":{start:{line:104,column:2},end:{line:120,column:5}},"45":{start:{line:105,column:4},end:{line:119,column:7}},"46":{start:{line:106,column:17},end:{line:108,column:8}},"47":{start:{line:109,column:25},end:{line:109,column:87}},"48":{start:{line:110,column:21},end:{line:110,column:46}},"49":{start:{line:112,column:6},end:{line:118,column:9}},"50":{start:{line:122,column:2},end:{line:154,column:5}},"51":{start:{line:123,column:19},end:{line:123,column:37}},"52":{start:{line:124,column:20},end:{line:124,column:35}},"53":{start:{line:125,column:18},end:{line:125,column:28}},"54":{start:{line:128,column:4},end:{line:130,column:7}},"55":{start:{line:129,column:6},end:{line:129,column:35}},"56":{start:{line:132,column:4},end:{line:142,column:7}},"57":{start:{line:133,column:6},end:{line:138,column:9}},"58":{start:{line:134,column:8},end:{line:134,column:56}},"59":{start:{line:135,column:8},end:{line:135,column:46}},"60":{start:{line:136,column:8},end:{line:136,column:62}},"61":{start:{line:137,column:8},end:{line:137,column:36}},"62":{start:{line:140,column:23},end:{line:140,column:62}},"63":{start:{line:141,column:6},end:{line:141,column:42}},"64":{start:{line:144,column:4},end:{line:153,column:7}},"65":{start:{line:145,column:6},end:{line:147,column:9}},"66":{start:{line:146,column:8},end:{line:146,column:30}},"67":{start:{line:149,column:6},end:{line:152,column:9}},"68":{start:{line:150,column:8},end:{line:150,column:45}},"69":{start:{line:151,column:8},end:{line:151,column:15}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:32},end:{line:5,column:33}},loc:{start:{line:5,column:38},end:{line:155,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:12,column:13},end:{line:12,column:14}},loc:{start:{line:12,column:19},end:{line:35,column:3}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:37,column:35},end:{line:37,column:36}},loc:{start:{line:37,column:41},end:{line:43,column:3}},line:37},"3":{name:"(anonymous_3)",decl:{start:{line:38,column:38},end:{line:38,column:39}},loc:{start:{line:38,column:44},end:{line:42,column:5}},line:38},"4":{name:"(anonymous_4)",decl:{start:{line:45,column:28},end:{line:45,column:29}},loc:{start:{line:45,column:34},end:{line:102,column:3}},line:45},"5":{name:"(anonymous_5)",decl:{start:{line:51,column:15},end:{line:51,column:16}},loc:{start:{line:51,column:21},end:{line:59,column:5}},line:51},"6":{name:"(anonymous_6)",decl:{start:{line:54,column:62},end:{line:54,column:63}},loc:{start:{line:54,column:79},end:{line:58,column:7}},line:54},"7":{name:"(anonymous_7)",decl:{start:{line:61,column:54},end:{line:61,column:55}},loc:{start:{line:61,column:64},end:{line:69,column:5}},line:61},"8":{name:"(anonymous_8)",decl:{start:{line:63,column:14},end:{line:63,column:15}},loc:{start:{line:63,column:20},end:{line:66,column:9}},line:63},"9":{name:"(anonymous_9)",decl:{start:{line:71,column:32},end:{line:71,column:33}},loc:{start:{line:71,column:42},end:{line:81,column:5}},line:71},"10":{name:"(anonymous_10)",decl:{start:{line:73,column:62},end:{line:73,column:63}},loc:{start:{line:73,column:79},end:{line:75,column:7}},line:73},"11":{name:"(anonymous_11)",decl:{start:{line:77,column:36},end:{line:77,column:37}},loc:{start:{line:77,column:47},end:{line:80,column:7}},line:77},"12":{name:"(anonymous_12)",decl:{start:{line:83,column:47},end:{line:83,column:48}},loc:{start:{line:83,column:59},end:{line:87,column:5}},line:83},"13":{name:"(anonymous_13)",decl:{start:{line:89,column:64},end:{line:89,column:65}},loc:{start:{line:89,column:76},end:{line:92,column:5}},line:89},"14":{name:"(anonymous_14)",decl:{start:{line:94,column:66},end:{line:94,column:67}},loc:{start:{line:94,column:78},end:{line:101,column:5}},line:94},"15":{name:"(anonymous_15)",decl:{start:{line:104,column:34},end:{line:104,column:35}},loc:{start:{line:104,column:40},end:{line:120,column:3}},line:104},"16":{name:"(anonymous_16)",decl:{start:{line:105,column:49},end:{line:105,column:50}},loc:{start:{line:105,column:55},end:{line:119,column:5}},line:105},"17":{name:"(anonymous_17)",decl:{start:{line:122,column:30},end:{line:122,column:31}},loc:{start:{line:122,column:36},end:{line:154,column:3}},line:122},"18":{name:"(anonymous_18)",decl:{start:{line:128,column:15},end:{line:128,column:16}},loc:{start:{line:128,column:21},end:{line:130,column:5}},line:128},"19":{name:"(anonymous_19)",decl:{start:{line:132,column:49},end:{line:132,column:50}},loc:{start:{line:132,column:61},end:{line:142,column:5}},line:132},"20":{name:"(anonymous_20)",decl:{start:{line:133,column:65},end:{line:133,column:66}},loc:{start:{line:133,column:82},end:{line:138,column:7}},line:133},"21":{name:"(anonymous_21)",decl:{start:{line:144,column:32},end:{line:144,column:33}},loc:{start:{line:144,column:42},end:{line:153,column:5}},line:144},"22":{name:"(anonymous_22)",decl:{start:{line:145,column:65},end:{line:145,column:66}},loc:{start:{line:145,column:82},end:{line:147,column:7}},line:145},"23":{name:"(anonymous_23)",decl:{start:{line:149,column:46},end:{line:149,column:47}},loc:{start:{line:149,column:57},end:{line:152,column:7}},line:149}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},b:{},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const sinon=(cov_2i7ou9xy9q.s[0]++,require('sinon'));// eslint-disable-line import/no-extraneous-dependencies
const{expect}=(cov_2i7ou9xy9q.s[1]++,require('chai'));// eslint-disable-line import/no-extraneous-dependencies
const GoogleSheet=(cov_2i7ou9xy9q.s[2]++,require('./GoogleSheet'));cov_2i7ou9xy9q.s[3]++;describe('[class] GoogleSheet',()=>{cov_2i7ou9xy9q.f[0]++;/* eslint  no-unused-expressions:0 */let token;let oauth;let config;cov_2i7ou9xy9q.s[4]++;beforeEach(()=>{cov_2i7ou9xy9q.f[1]++;cov_2i7ou9xy9q.s[5]++;token={access_token:'ya29.GlvlBl0RsTtU8uZNOI5P5ErrGPVm5OXB9YfgScGANfBaIxj5qAhYC5N1QPWpWyqzagy4neR3kRBLM6Vxd2fdU0KppVOZSMBbn1i2snGg9Xj_kxRGjTRHDSAWvsrB',refresh_token:'1/kSncFfEAZy5tgIknvaUhr4T8EW6FvpOTBofUNwBBLO8',scope:'https://www.googleapis.com/auth/spreadsheets',token_type:'Bearer',expiry_date:1554684728523};cov_2i7ou9xy9q.s[6]++;oauth={client_id:'164451747151-a2q7iceav90r07d83g7gp3n2q7gg25bz.apps.googleusercontent.com',project_id:'quickstart-1551572748055',auth_uri:'https://accounts.google.com/o/oauth2/auth',token_uri:'https://oauth2.googleapis.com/token',auth_provider_x509_cert_url:'https://www.googleapis.com/oauth2/v1/certs',client_secret:'hCFQR_ffk5HUDOQGQOoETlyM',redirect_uris:['urn:ietf:wg:oauth:2.0:oob','http://localhost']};cov_2i7ou9xy9q.s[7]++;config={token,installed:oauth};});cov_2i7ou9xy9q.s[8]++;describe('[method] constructor',()=>{cov_2i7ou9xy9q.f[2]++;cov_2i7ou9xy9q.s[9]++;it('should export a constructor',()=>{cov_2i7ou9xy9q.f[3]++;const gs=(cov_2i7ou9xy9q.s[10]++,new GoogleSheet(config));cov_2i7ou9xy9q.s[11]++;expect(gs).to.be.instanceOf(GoogleSheet);});});cov_2i7ou9xy9q.s[12]++;describe('[method] load',()=>{cov_2i7ou9xy9q.f[4]++;const values=(cov_2i7ou9xy9q.s[13]++,[['some','data']]);const sheetId=(cov_2i7ou9xy9q.s[14]++,'some-sheet-id');const range=(cov_2i7ou9xy9q.s[15]++,'Tab!A1:B');let gs;cov_2i7ou9xy9q.s[16]++;beforeEach(()=>{cov_2i7ou9xy9q.f[5]++;cov_2i7ou9xy9q.s[17]++;gs=new GoogleSheet(config);cov_2i7ou9xy9q.s[18]++;sinon.stub(gs.api.spreadsheets.values,'get').callsFake((options,cb)=>{cov_2i7ou9xy9q.f[6]++;cov_2i7ou9xy9q.s[19]++;expect(options.spreadsheetId).to.equal(sheetId);cov_2i7ou9xy9q.s[20]++;expect(options.range).to.equal(range);cov_2i7ou9xy9q.s[21]++;cb(null,{data:{values}});});});cov_2i7ou9xy9q.s[22]++;it('should load sheet data, returning a promise',done=>{cov_2i7ou9xy9q.f[7]++;cov_2i7ou9xy9q.s[23]++;gs.load(sheetId,range).then(()=>{cov_2i7ou9xy9q.f[8]++;cov_2i7ou9xy9q.s[24]++;expect(gs.rows).to.be.an('array');cov_2i7ou9xy9q.s[25]++;expect(gs.rows).to.have.lengthOf(1);}).then(done).catch(done);});cov_2i7ou9xy9q.s[26]++;it('should reject w/error',done=>{cov_2i7ou9xy9q.f[9]++;cov_2i7ou9xy9q.s[27]++;gs.api.spreadsheets.values.get.restore();cov_2i7ou9xy9q.s[28]++;sinon.stub(gs.api.spreadsheets.values,'get').callsFake((options,cb)=>{cov_2i7ou9xy9q.f[10]++;cov_2i7ou9xy9q.s[29]++;cb({name:'Boom!'});});cov_2i7ou9xy9q.s[30]++;gs.load(sheetId,range).catch(error=>{cov_2i7ou9xy9q.f[11]++;cov_2i7ou9xy9q.s[31]++;expect(error.name).to.equal('Boom!');cov_2i7ou9xy9q.s[32]++;done();});});cov_2i7ou9xy9q.s[33]++;it('should load sheet data, await syntax',async()=>{cov_2i7ou9xy9q.f[12]++;cov_2i7ou9xy9q.s[34]++;await gs.load(sheetId,range);cov_2i7ou9xy9q.s[35]++;expect(gs.rows).to.be.an('array');cov_2i7ou9xy9q.s[36]++;expect(gs.rows).to.have.lengthOf(1);});cov_2i7ou9xy9q.s[37]++;it('should load sheet data raw if no column headers given',async()=>{cov_2i7ou9xy9q.f[13]++;cov_2i7ou9xy9q.s[38]++;await gs.load(sheetId,range);cov_2i7ou9xy9q.s[39]++;expect(gs.rows).to.deep.equal(values);});cov_2i7ou9xy9q.s[40]++;it('should load sheet data inflated if column headers given',async()=>{cov_2i7ou9xy9q.f[14]++;cov_2i7ou9xy9q.s[41]++;gs.orderedColumnHeaders=['H1','H2'];cov_2i7ou9xy9q.s[42]++;await gs.load(sheetId,range);cov_2i7ou9xy9q.s[43]++;expect(gs.rows).to.deep.equal([{H1:values[0][0],H2:values[0][1]}]);});});cov_2i7ou9xy9q.s[44]++;describe('[method] inflateRow',()=>{cov_2i7ou9xy9q.f[15]++;cov_2i7ou9xy9q.s[45]++;it('should convert a flat row to an object',()=>{cov_2i7ou9xy9q.f[16]++;const gs=(cov_2i7ou9xy9q.s[46]++,new GoogleSheet(config,{orderedColumnHeaders:['first','last','source','email','targetFrequency']}));const rawRowData=(cov_2i7ou9xy9q.s[47]++,['John','Doe','High School','john.doe@gmail.com','weekly']);const rowObj=(cov_2i7ou9xy9q.s[48]++,gs.inflateRow(rawRowData));cov_2i7ou9xy9q.s[49]++;expect(rowObj).to.deep.equal({first:'John',last:'Doe',source:'High School',email:'john.doe@gmail.com',targetFrequency:'weekly'});});});cov_2i7ou9xy9q.s[50]++;describe('[method] update',()=>{cov_2i7ou9xy9q.f[17]++;const values=(cov_2i7ou9xy9q.s[51]++,[['some','data']]);const sheetId=(cov_2i7ou9xy9q.s[52]++,'some-sheet-id');const range=(cov_2i7ou9xy9q.s[53]++,'Tab!A1:B');let gs;cov_2i7ou9xy9q.s[54]++;beforeEach(()=>{cov_2i7ou9xy9q.f[18]++;cov_2i7ou9xy9q.s[55]++;gs=new GoogleSheet(config);});cov_2i7ou9xy9q.s[56]++;it('should update sheet data, await syntax',async()=>{cov_2i7ou9xy9q.f[19]++;cov_2i7ou9xy9q.s[57]++;sinon.stub(gs.api.spreadsheets.values,'update').callsFake((options,cb)=>{cov_2i7ou9xy9q.f[20]++;cov_2i7ou9xy9q.s[58]++;expect(options.spreadsheetId).to.equal(sheetId);cov_2i7ou9xy9q.s[59]++;expect(options.range).to.equal(range);cov_2i7ou9xy9q.s[60]++;expect(options.resource.values).to.deep.equal(values);cov_2i7ou9xy9q.s[61]++;cb(null,{success:true});});const response=(cov_2i7ou9xy9q.s[62]++,await gs.update(sheetId,range,values));cov_2i7ou9xy9q.s[63]++;expect(response.success).to.be.true;});cov_2i7ou9xy9q.s[64]++;it('should reject w/error',done=>{cov_2i7ou9xy9q.f[21]++;cov_2i7ou9xy9q.s[65]++;sinon.stub(gs.api.spreadsheets.values,'update').callsFake((options,cb)=>{cov_2i7ou9xy9q.f[22]++;cov_2i7ou9xy9q.s[66]++;cb({name:'Boom!'});});cov_2i7ou9xy9q.s[67]++;gs.update(sheetId,range,values).catch(error=>{cov_2i7ou9xy9q.f[23]++;cov_2i7ou9xy9q.s[68]++;expect(error.name).to.equal('Boom!');cov_2i7ou9xy9q.s[69]++;done();});});});});